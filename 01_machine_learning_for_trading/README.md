# Машинное обучение в торговле: от идеи до реализации

Алгоритмическая торговля основана на компьютерных программах, которые выполняют алгоритмы для автоматизации некоторых или всех элементов торговой стратегии. **Алгоритмы** — это последовательность шагов или правил, предназначенных для достижения определенной цели. Они могут принимать различные формы и способствовать оптимизации инвестиционного процесса, начиная с генерации идей и распределения активов и заканчивая исполнением сделок и управлением рисками.

**Машинное обучение** (ML) включает алгоритмы, которые извлекают правила или шаблоны из данных для достижения определенной цели, например минимизации ошибки прогноза. Примеры в этой книге покажут, как алгоритмы машинного обучения могут извлекать информацию из данных для поддержки или автоматизации ключевых инвестиционных процессов. Эти процессы включают наблюдение за рынком и анализ данных для формирования ожиданий относительно будущего, принятия решений о размещении ордеров на покупку или продажу, а также управление портфелем для получения привлекательной доходности относительно риска.

В конечном итоге, цель активного управления инвестициями заключается в генерации **альфы**, которая определяется как доходность портфеля, превышающая доходность бенчмарка, используемого для оценки. **Фундаментальный закон активного управления** гласит, что ключом к генерации альфы является наличие точных прогнозов доходности в сочетании со способностью действовать на основе этих прогнозов (Grinold 1989; Grinold and Kahn 2000).

Этот закон определяет **коэффициент информации** (IR) для выражения ценности активного управления как отношение разницы доходностей между портфелем и бенчмарком к волатильности этих доходностей. Он также приближенно выражает IR как произведение:
- **Коэффициента информации** (IC), который измеряет качество прогнозов через ранговую корреляцию с фактическими результатами.
- Квадратного корня из **охвата стратегии**, выраженного как количество независимых прогнозов.

Конкуренция между продвинутыми инвесторами на финансовых рынках подразумевает, что для точных прогнозов и генерации альфы требуется более качественная информация — будь то доступ к лучшим данным, более высокая способность к их обработке или и то, и другое. Именно здесь на помощь приходит машинное обучение: применение **ML в торговле (ML4T)** направлено на более эффективное использование стремительно расширяющегося спектра данных для создания более точных и действенных прогнозов, тем самым повышая качество инвестиционных решений и результатов.

Исторически алгоритмическая торговля определялась более узко как автоматизация исполнения сделок с целью минимизации издержек, предлагаемых продающей стороной. Однако в этой книге представлен более широкий взгляд, поскольку использование алгоритмов в целом и машинного обучения, в частности, оказывает влияние на более широкий спектр инвестиционной деятельности — от генерации идей и извлечения сигналов из данных до распределения активов, определения размера позиций, тестирования и оценки стратегий.

В этой главе мы рассмотрим отраслевые тенденции, которые привели к появлению машинного обучения как источника конкурентного преимущества в инвестиционной сфере. Мы также обсудим, какую роль ML играет в инвестиционном процессе для реализации алгоритмических торговых стратегий.
## Content

- [Машинное обучение в торговле: от идеи до реализации](#машинное-обучение-в-торговле-от-идеи-до-реализации)
  - [Content](#content)
  - [Рост машинного обучения в инвестиционной индустрии](#рост-машинного-обучения-в-инвестиционной-индустрии)
    - [От электронной торговли к высокочастотной торговле](#от-электронной-торговли-к-высокочастотной-торговле)
    - [Факторное инвестирование и фонды «умного» бета-индекса](#факторное-инвестирование-и-фонды-умного-бета-индекса)
    - [Алгоритмические пионеры превосходят человеческий фактор](#алгоритмические-пионеры-превосходят-человеческий-фактор)
      - [Фонды, управляемые машинным обучением, привлекают $1 трлн активов](#фонды-управляемые-машинным-обучением-привлекают-1-трлн-активов)
      - [Появление квантаментальных фондов](#появление-квантаментальных-фондов)
    - [Машинное обучение и альтернативные данные](#машинное-обучение-и-альтернативные-данные)
  - [Разработка и реализация стратегии, основанной на машинном обучении](#разработка-и-реализация-стратегии-основанной-на-машинном-обучении)
    - [Получение и управление данными](#получение-и-управление-данными)
    - [От исследования альфа-факторов к управлению портфелем](#от-исследования-альфа-факторов-к-управлению-портфелем)
    - [Тестирование стратегии (Backtesting)](#тестирование-стратегии-backtesting)
  - [Машинное обучение в торговле на практике: стратегии и примеры](#машинное-обучение-в-торговле-на-практике-стратегии-и-примеры)
    - [Эволюция алгоритмических стратегий (Algorithmic Strategies)](#эволюция-алгоритмических-стратегий-algorithmic-strategies)
    - [Современные алгоритмические стратегии](#современные-алгоритмические-стратегии)
    - [Примеры применения машинного обучения (ML) в торговле](#примеры-применения-машинного-обучения-ml-в-торговле)
      - [Анализ данных (Data Mining) для извлечения признаков (Feature Extraction) и аналитических выводов (Insights)](#анализ-данных-data-mining-для-извлечения-признаков-feature-extraction-и-аналитических-выводов-insights)
      - [Обучение с учителем (Supervised Learning) для создания и агрегации альфа-факторов (Alpha Factor Creation and Aggregation)](#обучение-с-учителем-supervised-learning-для-создания-и-агрегации-альфа-факторов-alpha-factor-creation-and-aggregation)
      - [Распределение активов (Asset Allocation)](#распределение-активов-asset-allocation)
      - [Тестирование торговых идей (Testing Trade Ideas)](#тестирование-торговых-идей-testing-trade-ideas)
      - [Обучение с подкреплением (Reinforcement Learning)](#обучение-с-подкреплением-reinforcement-learning)
  - [Ресурсы и ссылки (Resources \& References)](#ресурсы-и-ссылки-resources--references)
    - [Академические исследования (Academic Research)](#академические-исследования-academic-research)
    - [Industry News](#industry-news)
    - [Books](#books)
      - [Machine Learning](#machine-learning)
    - [Courses](#courses)
    - [ML Competitions \& Trading](#ml-competitions--trading)
    - [Python Libraries](#python-libraries)

## Рост машинного обучения в инвестиционной индустрии

Инвестиционная индустрия претерпела значительные изменения за последние десятилетия и продолжает эволюционировать на фоне усиливающейся конкуренции, технологических достижений и сложной экономической среды. В этом разделе рассматриваются ключевые тенденции, сформировавшие инвестиционную среду в целом, а также контекст для алгоритмической торговли и использования машинного обучения в частности.

Тенденции, способствовавшие развитию алгоритмической торговли и машинного обучения, включают:
- Изменения в микроструктуре рынка, такие как распространение электронных торговых платформ и интеграция рынков различных классов активов и географических регионов.
- Развитие инвестиционных стратегий, основанных на экспозиции к рисковым факторам, а не на традиционном распределении по классам активов.
- Революционные изменения в вычислительных мощностях, генерации и управлении данными, а также в статистических методах, включая прорывы в области глубинного обучения.
- Превосходство пионеров алгоритмической торговли по сравнению с традиционными инвесторами, полагающимися на дискреционные (человеческие) решения.

Кроме того, финансовые кризисы 2001 и 2008 годов изменили подход инвесторов к диверсификации и управлению рисками. Одним из последствий стало массовое распространение недорогих пассивных инвестиционных инструментов в форме биржевых фондов (ETF). В условиях низкой доходности и низкой волатильности после кризиса 2008 года, когда ведущие центральные банки начали масштабные покупки активов, ориентированные на снижение затрат инвесторы переместили более **$3,5 трлн** из активно управляемых паевых инвестиционных фондов в пассивно управляемые ETF.

Конкурентное давление также отразилось на снижении комиссий хедж-фондов. Если традиционно они составляли 2% годового управления активами и 20% от прибыли, то в 2017 году средние показатели снизились до **1,48%** и **17,4%** соответственно.

### От электронной торговли к высокочастотной торговле

Электронная торговля значительно продвинулась вперед с точки зрения возможностей, объемов, охвата классов активов и географических рынков с тех пор, как в 1960-х годах сети начали передавать котировки на компьютерные терминалы.

- [Dark Pool Trading & Finance](https://www.cfainstitute.org/en/advocacy/issues/dark-pools), CFA Institute
- [Dark Pools in Equity Trading: Policy Concerns and Recent Developments](https://crsreports.congress.gov/product/pdf/R/R43739), Congressional Research Service, 2014
- [High Frequency Trading: Overview of Recent Developments](https://fas.org/sgp/crs/misc/R44443.pdf), Congressional Research Service, 2016

### Факторное инвестирование и фонды «умного» бета-индекса  

Доходность актива является функцией неопределенности или риска, связанного с финансовыми инвестициями. Например, инвестиции в акции означают принятие на себя бизнес-риска компании, а инвестиции в облигации — принятие риска дефолта.  

Если определенные характеристики риска предсказывают доходность, то выявление и прогнозирование поведения этих факторов риска становится главным приоритетом при разработке инвестиционной стратегии. Это позволяет получать ценные торговые сигналы и является ключом к успешному активному управлению. Понимание факторов риска в индустрии инвестиций значительно эволюционировало со временем и повлияло на то, как машинное обучение используется в алгоритмической торговле.  

Факторы, объясняющие доходность сверх модели оценки капитальных активов (CAPM), были интегрированы в инвестиционные стили, которые смещают портфели в пользу одного или нескольких факторов. В результате активы начали перетекать в факторные портфели. Финансовый кризис 2008 года подчеркнул, насколько вводящими в заблуждение могут быть традиционные классификации классов активов и как они создают ложное ощущение диверсификации, если инвесторы не учитывают факторы риска. Это стало очевидно, когда различные классы активов одновременно обрушились.  

За последние десятилетия количественное факторное инвестирование эволюционировало от простого подхода, основанного на двух-трех стилях, до многофакторных стратегий **"умного" или "экзотического" бета-индекса**. В 2017 году активы под управлением (AUM) фондов **smart beta** превысили **$1 трлн**, что свидетельствует о популярности гибридной инвестиционной стратегии, сочетающей активное и пассивное управление. Фонды **smart beta** следуют пассивной стратегии, но адаптируют ее с учетом одного или нескольких факторов — например, отбирают более дешевые акции или ориентируются на выплату дивидендов для получения более высокой доходности. Рост таких стратегий сопровождался критикой высоких комиссий традиционных управляющих активами и повышенным вниманием к их реальной эффективности.  

Продолжающееся открытие и успешное прогнозирование факторов риска, которые — как по отдельности, так и в сочетании с другими факторами — значительно влияют на будущую доходность активов различных классов, является ключевым двигателем роста машинного обучения в инвестиционной индустрии. Эта тема будет центральной на протяжении всей книги.

### Алгоритмические пионеры превосходят человеческий фактор  

История успеха и рост активов под управлением (AUM) компаний, ставших первопроходцами в алгоритмической торговле, сыграли ключевую роль в привлечении интереса инвесторов и последующих усилиях индустрии по воспроизведению их успеха.  

Систематические стратегии, которые преимущественно или полностью полагаются на алгоритмическое принятие решений, наиболее известны благодаря математику **Джеймсу Саймонсу**, основавшему **Renaissance Technologies** в 1982 году и превратившему её в ведущую количественную инвестиционную компанию. Её закрытый для внешних инвесторов фонд **Medallion Fund** показал **среднегодовую доходность около 35% с 1982 года**, что делает его одним из самых успешных инвестиционных инструментов в истории.  

**DE Shaw, Citadel и Two Sigma** — три из самых известных количественных хедж-фондов, использующих систематические стратегии, основанные на алгоритмах. В 2017 году они впервые вошли в **топ-20 лучших фондов** всех времён по общему объёму заработанных для инвесторов средств (за вычетом комиссий) с момента основания.

#### Фонды, управляемые машинным обучением, привлекают $1 трлн активов  

В 2017 году **Morgan Stanley** оценил, что алгоритмические стратегии росли в среднем **на 15% в год** в течение предыдущих шести лет и контролировали около **$1,5 трлн** активов, включая **хедж-фонды, взаимные фонды и Smart Beta ETF**.  

Другие исследования указывают, что индустрия **количественных хедж-фондов** была на грани преодоления отметки **$1 трлн AUM**, почти **удвоив** свой размер с 2010 года, несмотря на отток капитала из традиционных хедж-фондов.  

Для сравнения, общий капитал **хедж-фондов** составил **$3,21 трлн**, согласно последнему **глобальному отчету Hedge Fund Research**.

- [Global Algorithmic Trading Market to Surpass US$ 21,685.53 Million by 2026](https://www.bloomberg.com/press-releases/2019-02-05/global-algorithmic-trading-market-to-surpass-us-21-685-53-million-by-2026)
- [The stockmarket is now run by computers, algorithms and passive managers](https://www.economist.com/briefing/2019/10/05/the-stockmarket-is-now-run-by-computers-algorithms-and-passive-managers), Economist, Oct 5, 2019

#### Появление квантаментальных фондов  

В активном управлении инвестициями развились два различных подхода: **систематический (quant)** и **дискреционный (discretionary)**.  

- **Систематические стратегии** полагаются на алгоритмы для выявления инвестиционных возможностей на основе данных и повторяемых методов анализа множества финансовых инструментов.  
- **Дискреционный подход**, напротив, предполагает глубокий анализ ограниченного числа активов.  

Однако эти два подхода **становятся всё более схожими**, поскольку фундаментальные управляющие всё чаще применяют методы анализа данных.  

Даже **фундаментальные трейдеры** теперь используют **количественные методы**, что, по данным **Barclays**, составляет **$55 млрд** систематических активов. Квантовые фонды, не привязываясь к конкретным компаниям, торгуют на основе паттернов и динамики широкого спектра активов.  

Согласно данным **Barclays**, **квантовые фонды теперь контролируют около 17% всех активов хедж-фондов**.

### Машинное обучение и альтернативные данные  

Хедж-фонды давно стремятся получить **альфу** за счёт информационного преимущества и способности выявлять **новые некоррелированные сигналы**. Исторически это включало такие методы, как проведение **закрытых опросов покупателей** или **избирателей** перед выборами и референдумами.  

Иногда использование **инсайдерской информации** (например, данных от сотрудников компаний, врачей или экспертных сетей) для получения знаний о тенденциях в отрасли или отдельных компаниях пересекало **законные границы**. После 2010 года индустрия пережила **серию судебных разбирательств** против трейдеров, портфельных управляющих и аналитиков, использовавших инсайдерскую информацию.  

В отличие от этого, **информационное преимущество** при использовании **конвенциональных и альтернативных данных** через **машинное обучение** не связано с доступом к корпоративному менеджменту или экспертным сетям. Оно основывается на **способности собирать и анализировать огромные объёмы данных в реальном времени**.  

Три ключевые тенденции **революционизировали** использование данных в алгоритмических торговых стратегиях и могут **ещё больше сместить** инвестиционную индустрию от дискреционного управления к количественным методам:  

- **Экспоненциальный рост** объёма цифровых данных  
- **Рост вычислительных мощностей** и ёмкости хранилищ при снижении их стоимости  
- **Прогресс методов машинного обучения** для анализа сложных наборов данных  

- [Can We Predict the Financial Markets Based on Google's Search Queries?](https://onlinelibrary.wiley.com/doi/abs/10.1002/for.2446), Perlin, et al, 2016, Journal of Forecasting

## Разработка и реализация стратегии, основанной на машинном обучении  

Машинное обучение может **добавлять ценность** на различных этапах жизненного цикла торговой стратегии, опираясь на **ключевую инфраструктуру и данные**. Поэтому эта книга посвящена тому, как методы **ML** интегрируются в общий процесс **разработки, исполнения и оценки** стратегий.  

Алгоритмическая торговая стратегия строится на основе **альфа-факторов**, которые преобразуют один или несколько источников данных в **сигналы**, прогнозирующие будущую доходность активов и инициирующие **ордера на покупку или продажу**.  

- **Глава 2** – *Рыночные и фундаментальные данные* и **Глава 3** – *Альтернативные данные для финансов* рассматривают **поиск и управление данными**, которые являются **сырьём** и **ключевым драйвером** успешной торговой стратегии.  
- **[Глава 4, Исследование альфа-факторов](../04_alpha_factor_research)** описывает **методологически обоснованный процесс**, позволяющий управлять риском ложных открытий, который возрастает с увеличением объёма данных.  
- **[Глава 5, Оценка стратегии](../05_strategy_evaluation)** обеспечивает контекст для **исполнения и измерения эффективности** торговой стратегии.  

Следующие подразделы кратко описывают **основные этапы**, которые мы детально рассмотрим в течение всей книги.

### Получение и управление данными  

**Резкое увеличение доступности данных** — по объёму, разнообразию и скорости поступления — стало **ключевым фактором** применения машинного обучения в торговле. В свою очередь, это стимулировало **рост затрат индустрии** на приобретение новых источников данных. Однако **быстрое расширение** объёма данных требует **тщательного отбора и управления**, чтобы извлекать из них реальную ценность. Этот процесс включает следующие шаги:  

1. **Идентификация и оценка** рыночных, фундаментальных и альтернативных источников данных, содержащих **альфа-сигналы**, которые **не исчезают слишком быстро**.  
2. **Развертывание или доступ** к **масштабируемой облачной инфраструктуре данных** и аналитическим инструментам, таким как **Hadoop** или **Spark**, для **быстрого и гибкого доступа** к информации.  
3. **Тщательное управление и обработка данных** для предотвращения **ошибки заглядывания в будущее** (*look-ahead bias*). Данные должны быть **приведены к нужной частоте и отражать только доступную на тот момент информацию**. Алгоритмы ML, обученные на **искажённых исторических данных**, почти **гарантированно потерпят неудачу** при реальной торговле.  

Эти аспекты мы подробно рассмотрим в **Глава 2: Рыночные и фундаментальные данные: источники и методы** и **Глава 3: Альтернативные данные для финансов: категории и примеры использования**.

### От исследования альфа-факторов к управлению портфелем  

**Альфа-факторы** предназначены для **извлечения сигналов из данных** с целью прогнозирования доходности активов в рамках определённой инвестиционной вселенной на заданном торговом горизонте. Каждый фактор принимает **одно значение для каждого актива**, но при этом может основываться **на одной или нескольких входных переменных**. Процесс их разработки включает **следующие этапы**:  

Этап **исследования** в рабочем процессе торговой стратегии включает **разработку, оценку и комбинирование альфа-факторов**. Машинное обучение играет **важную роль** в этом процессе, поскольку **сложность факторов** возросла. Это связано как с реакцией инвесторов на **деградацию сигналов простых факторов**, так и с тем, что сегодня доступно **значительно больше данных**.  

**Альфа-факторы** генерируют **сигналы входа и выхода**, приводящие к ордерам на **покупку или продажу**. Исполнение ордеров формирует **структуру портфеля**, в котором **рисковые профили отдельных позиций** взаимодействуют, создавая **общий риск-профиль портфеля**.  

**Управление портфелем** включает **оптимизацию весов позиций**, чтобы достичь **желаемого уровня риска и доходности**, соответствующего общей инвестиционной стратегии. Этот процесс **динамичен** и постоянно **адаптируется к изменяющимся рыночным данным**.

### Тестирование стратегии (Backtesting)  

Внедрение инвестиционной идеи в алгоритмическую стратегию требует **широкомасштабного тестирования** с **научным подходом**, который предполагает **попытку опровергнуть идею**, анализируя её эффективность в различных **вневыборочных рыночных сценариях** (*out-of-sample*).  

Тестирование может включать **использование смоделированных данных**, чтобы учесть возможные сценарии, которые **не отражены в исторических данных**, но считаются вероятными.  

## Машинное обучение в торговле на практике: стратегии и примеры  

На практике **машинное обучение** применяется к торговле в рамках **конкретной стратегии**, направленной на **достижение определённых бизнес-целей**. В этом разделе мы кратко рассмотрим, **как эволюционировали и диверсифицировались** торговые стратегии, а также приведём **реальные примеры** применения **ML**.  

При этом будет подчеркнута связь этих примеров **с темами, рассмотренными в данной книге**.

### Эволюция алгоритмических стратегий (Algorithmic Strategies)  

Количественные стратегии (Quantitative Strategies) **эволюционировали** и стали более сложными в ходе **трёх волн развития**:  

1. В **1980-х и 1990-х годах** торговые сигналы (Signals) часто появлялись из **академических исследований** и базировались на **одном или нескольких входных параметрах**, извлечённых из **рыночных данных (Market Data)** и **фундаментальных данных (Fundamental Data)**.  
   - Например, AQR, один из крупнейших **количественных хедж-фондов (Quantitative Hedge Funds)** сегодня, был основан в **1998 году** для масштабного внедрения таких стратегий.  
   - Эти сигналы сейчас в значительной степени **стандартизированы** и доступны через **биржевые фонды (ETF, Exchange-Traded Funds)**, например, через **стратегии среднего реверсирования (Mean-Reversion Strategies)**.  

2. В **2000-х годах** широкое распространение получило **факторное инвестирование (Factor-Based Investing)** благодаря **пионерским исследованиям Юджина Фамы и Кеннета Френча**.  
   - Фонды использовали **алгоритмы (Algorithms)** для идентификации активов, подверженных **рисковым факторам (Risk Factors)**, таким как **стоимость (Value)** или **моментум (Momentum)**, с целью **поиска арбитражных возможностей (Arbitrage Opportunities)**.  
   - В начале **финансового кризиса 2007–2008 годов** массовый вывод средств (**Redemptions**) спровоцировал **"количественный обвал" (Quant Quake) в августе 2007 года**, который затронул всю индустрию факторных фондов.  
   - В настоящее время эти стратегии также доступны в виде **долгосрочных фондов "умного" бета-индекса (Smart Beta Funds)**, которые **смещают портфель (Tilt Portfolios)** в соответствии с **определённым набором рисковых факторов (Risk Factors)**.  

3. **Третья эра** связана с **развитием машинного обучения (ML, Machine Learning)** и **использованием альтернативных данных (Alternative Data)** для **генерации прибыльных торговых сигналов** в рамках **повторяемых стратегий (Repeatable Trading Strategies)**.  
   - Основная проблема – **затухание факторов (Factor Decay)**:  
     - Избыточная доходность (Excess Returns) **новых рыночных аномалий** падает **на 25%** между моментом открытия и публикацией,  
     - После публикации **она сокращается более чем на 50%** из-за конкуренции и перегруженности стратегий (**Competition and Crowding**).  

### Современные алгоритмические стратегии  

Сегодня трейдеры используют алгоритмы для **различных целей**:  
- **Алгоритмы исполнения сделок (Trade Execution Algorithms)**, которые стремятся добиться **наиболее выгодных цен (Favorable Pricing)**.  
- **Краткосрочные сделки (Short-Term Trades)**, нацеленные на **извлечение прибыли из небольших колебаний цен (Small Price Movements)**, например, за счёт **арбитража (Arbitrage)**.  
- **Поведенческие стратегии (Behavioral Strategies)**, которые пытаются **предсказать поведение других участников рынка (Market Participants)**.  
- **Стратегии, основанные на прогнозах абсолютных и относительных цен и доходности (Trading Strategies Based on Absolute and Relative Price and Return Predictions)**.

### Примеры применения машинного обучения (ML) в торговле  

**Машинное обучение (ML, Machine Learning)** извлекает **торговые сигналы (Trading Signals)** из широкого спектра **рыночных (Market Data), фундаментальных (Fundamental Data) и альтернативных данных (Alternative Data)**. Оно может применяться **на всех этапах процесса алгоритмической торговли (Algorithmic Trading Strategy Process)**. Ключевые области применения включают:  

- **Анализ данных (Data Mining)** для **выявления паттернов (Patterns), извлечения признаков (Feature Extraction) и формирования аналитических выводов (Insights)**.  
- **Обучение с учителем (Supervised Learning)** для **генерации факторов риска (Risk Factors) или альфа-факторов (Alphas) и создания торговых идей (Trade Ideas)**.  
- **Агрегацию индивидуальных сигналов (Aggregation of Individual Signals)** в рамках единой **торговой стратегии (Strategy)**.  
- **Распределение активов (Asset Allocation)** в соответствии с **рисковыми профилями (Risk Profiles)**, которые **обученный алгоритм (Algorithm) распознаёт**.  
- **Тестирование и оценку стратегий (Strategy Testing and Evaluation)**, включая использование **синтетических данных (Synthetic Data)**.  
- **Интерактивную автоматизированную оптимизацию стратегии (Automated Refinement of a Strategy)** с применением **обучения с подкреплением (Reinforcement Learning)**.  

Далее мы кратко рассмотрим некоторые из этих **применений** и укажем, в каких главах книги они будут подробно разобраны.

#### Анализ данных (Data Mining) для извлечения признаков (Feature Extraction) и аналитических выводов (Insights)  

**Эффективная обработка (Cost-Effective Evaluation) больших и сложных наборов данных (Large, Complex Datasets)** требует выявления **масштабируемых сигналов (Signals at Scale)**. В книге представлено несколько примеров:  

- **Теория информации (Information Theory)** помогает оценить **информационное содержание (Signal Content)** потенциальных признаков (Features), что полезно для **выделения наиболее ценных входных данных (Most Valuable Inputs) для модели машинного обучения (ML Model)**.  
  - В **Главе 4** (*Financial Feature Engineering: How to Research Alpha Factors*) мы используем **взаимную информацию (Mutual Information)** для сравнения потенциальной ценности отдельных признаков для алгоритма **обучения с учителем (Supervised Learning)**, предсказывающего доходность активов (Asset Returns).  
  - В **Главе 18 книги Де Прадо (2018)** анализируется **информационное содержание ценового ряда (Information Content of a Price Series)** как основа для выбора **между альтернативными торговыми стратегиями (Alternative Trading Strategies)**.  

- **Обучение без учителя (Unsupervised Learning)** предоставляет широкий спектр методов для **идентификации структуры данных (Identifying Structure in Data)**, получения аналитических выводов (Insights) или решения последующих задач (**Downstream Task**). Мы приводим несколько примеров:  
  - В **Главе 13** [Unsupervised Learning: From Data-Driven Risk Factors to Hierarchical Risk Parity](../13_unsupervised_learning/README.md) мы рассматриваем **кластеризацию (Clustering) и сокращение размерности (Dimensionality Reduction)** для генерации признаков из **высокомерных данных (High-Dimensional Datasets)**.  
  - В **Главе 15** [Topic Modeling for Earnings Calls and Financial News](../15_topic_modeling/README.md), мы применяем **байесовские вероятностные модели (Bayesian Probability Models)** для **обобщения финансовых текстовых данных (Summarizing Financial Text Data)**.  
  - В **Главе 20** [Autoencoders for Conditional Risk Factors](../20_autoencoders_for_conditional_risk_factors) мы используем **глубинное обучение (Deep Learning)** для **извлечения нелинейных факторов риска (Non-Linear Risk Factors)**, зависящих от характеристик активов (Asset Characteristics), а также предсказания доходности акций (Stock Returns) на основе исследования [Kelly et. al.](https://www.aqr.com/Insights/Research/Working-Paper/Autoencoder-Asset-Pricing-Models) (2020).  

- **Прозрачность моделей (Model Transparency)**:  
  - Мы уделяем внимание методам **интерпретации предсказательной силы (Predictive Power) отдельных переменных**.  
  - Представляем **новый гейм-теоретический метод (Game-Theoretic Approach)** — **SHapley Additive exPlanations (SHAP)**.  
  - Применяем его для **градиентного бустинга (Gradient Boosting Machines)** с **большим количеством входных переменных (Large Number of Input Variables)** в **Главе 12** (*Boosting Your Trading Strategy and the Appendix*).

#### Обучение с учителем (Supervised Learning) для создания и агрегации альфа-факторов (Alpha Factor Creation and Aggregation)  

Наиболее очевидная причина применения **машинного обучения (ML, Machine Learning)** в торговле — это **предсказание фундаментальных показателей активов (Asset Fundamentals), движения цен (Price Movements) или состояния рынка (Market Conditions)**.  

Торговая стратегия может использовать **несколько алгоритмов ML**, которые дополняют друг друга:  

- **Модели последующих уровней (Downstream Models)** могут **генерировать сигналы (Generate Signals)** на уровне **портфеля (Portfolio Level)**, объединяя прогнозы **перспектив отдельных активов (Prospects of Individual Assets), ожидания рынка капитала (Capital Market Expectations) и корреляции между ценными бумагами (Correlation Among Securities)**.  
- Альтернативно, **ML-прогнозы (ML Predictions)** могут использоваться для **дискреционных сделок (Discretionary Trades)** в рамках **квантаментального подхода (Quantamental Approach)**, рассмотренного ранее.  

**ML-прогнозы могут быть нацелены на определённые факторы риска (Risk Factors)**, такие как **стоимость (Value)** или **волатильность (Volatility)**, или реализовывать технические подходы, например **следование за трендом (Trend-Following)** или **средневозвратность (Mean Reversion)**:  

- В **Главе 3**, [Alternative Data for Finance: Categories and Use Cases](../03_alternative_data/README.md), мы рассматриваем, как работать с **фундаментальными данными (Fundamental Data)** для создания входных параметров для **ML-моделей оценки стоимости (ML-Driven Valuation Models)**.  
- В **Главе 14**, [Text Data for Trading: Sentiment Analysis](../14_working_with_text_data/README.md), **Главе 15**, [Topic Modeling for Earnings Calls and Financial News](../15_topic_modeling/README.md), и **Главе 16**, [Extracting Better Features: Word Embeddings for Earnings Calls and SEC Filings](../16_word_embeddings/README.md), мы используем **альтернативные данные (Alternative Data)** о **бизнес-обзорах (Business Reviews)** для прогнозирования **доходов компании (Company Revenues)** как **входных данных для оценки стоимости (Valuation Exercise)**.  
- В **Главе 9**, [From Volatility Forecasts to Statistical Arbitrage: Time Series Models](../09_time_series_models/README.md), мы показываем, как прогнозировать **макроэкономические переменные (Macro Variables)** для **рыночных ожиданий (Market Expectations)** и прогнозировать **факторы риска (Risk Factors)**, такие как **волатильность (Volatility)**.  
- В **Главе 19**, [RNNs for Trading: Multivariate Return Series and Text Data](../19_recurrent_neural_nets/README.md), мы рассматриваем **рекуррентные нейронные сети (Recurrent Neural Networks, RNNs)**, которые демонстрируют **высокую производительность (Superior Performance)** при работе с **нелинейными временными рядами (Nonlinear Time Series Data)**.

#### Распределение активов (Asset Allocation)  

**Машинное обучение (ML, Machine Learning)** используется для **распределения активов (Allocate Portfolios)** на основе **деревьев решений (Decision-Tree Models)**, которые вычисляют **иерархическую форму паритета риска (Hierarchical Risk Parity)**. В результате **характеристики риска (Risk Characteristics)** формируются **на основе паттернов в ценах активов (Patterns in Asset Prices)**, а не на основе **классов активов (Asset Classes)**, что позволяет достичь **лучшего соотношения риска и доходности (Superior Risk-Return Characteristics)**.  

- В **Главе 5**, [Portfolio Optimization and Performance Evaluation](../05_strategy_evaluation/README.md), и **Главе 13**, [Unsupervised Learning: From Data-Driven Risk Factors to Hierarchical Risk Parity](../13_unsupervised_learning/README.md), мы рассматриваем, как **иерархическая кластеризация (Hierarchical Clustering)** выявляет **данные-ориентированные классы риска (Data-Driven Risk Classes)**, которые **лучше отражают корреляционные паттерны (Better Reflect Correlation Patterns)** по сравнению с **традиционными определениями классов активов (Conventional Asset Class Definition)** (см. **Главу 16** в **De Prado, 2018**).

#### Тестирование торговых идей (Testing Trade Ideas)  

**Бэктестинг (Backtesting)** — критический этап для выбора **успешных алгоритмических торговых стратегий (Successful Algorithmic Trading Strategies)**.  

- **Кросс-валидация (Cross-Validation)** с использованием **синтетических данных (Synthetic Data)** — это **ключевая техника ML (Key ML Technique)**, которая позволяет **генерировать достоверные вневыборочные результаты (Reliable Out-of-Sample Results)**.  
- Чтобы избежать **ошибки заглядывания в будущее (Look-Ahead Bias)** или загрязнения данных (Data Contamination), финансовые временные ряды (Financial Time-Series Data) требуют модификации стандартных методов.  
- Ограниченная доступность **исторических данных (Historical Data)** привела к разработке **альтернативных методов (Alternative Approaches)**, таких как использование **синтетических данных (Synthetic Data)**.  

Мы рассмотрим различные методы **тестирования ML-моделей (Testing ML Models)** с использованием **рыночных (Market Data), фундаментальных (Fundamental Data) и альтернативных данных (Alternative Data)**, позволяющие **оценивать вневыборочные ошибки (Out-of-Sample Errors)**.  

- В **Главе 21**, [Generative Adversarial Networks for Synthetic Training Data](../21_gans_for_synthetic_time_series/README.md), мы представим **генеративно-состязательные сети (GANs, Generative Adversarial Networks)**, способные **создавать высококачественные синтетические данные (Producing High-Quality Synthetic Data)**.  

---

#### Обучение с подкреплением (Reinforcement Learning)  

Торговля происходит в **конкурентной, интерактивной рыночной среде (Competitive, Interactive Marketplace)**.  

**Обучение с подкреплением (Reinforcement Learning, RL)** направлено на **тренировку интеллектуальных агентов (Training Agents)**, чтобы они **изучали функцию принятия решений (Policy Function) на основе вознаграждений (Rewards)**.  

- **RL считается одним из самых перспективных направлений в финансовом ML (One of the Most Promising Areas in Financial ML)**.  
- Примеры его применения к **исполнению торговых ордеров (Trade Execution)** см. в **Hendricks and Wilcox (2014)** и **Nevmyvaka, Feng, and Kearns (2006)**.  

- В **Главе 22**, [Deep Reinforcement Learning: Building a Trading Agent](../22_deep_reinforcement_learning/README.md), мы рассмотрим **ключевые алгоритмы обучения с подкреплением (Key Reinforcement Algorithms)**, такие как **Q-learning**, и покажем их применение для **обучения торговых агентов (Training Trading Agents)** с использованием **среды OpenAI Gym (OpenAI's Gym Environment)**.  

---

## Ресурсы и ссылки (Resources & References)  

### Академические исследования (Academic Research)  

- [The fundamental law of active management](http://jpm.iijournals.com/content/15/3/30), Richard C. Grinold, The Journal of Portfolio Management Spring 1989, 15 (3) 30-37
- [The relationship between return and market value of common stocks](https://www.sciencedirect.com/science/article/pii/0304405X81900180), Rolf Banz,Journal of Financial Economics, March 1981
- [The Arbitrage Pricing Theory: Some Empirical Results](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1981.tb00444.x), Marc Reinganum, Journal of Finance, 1981
- [The Relationship between Earnings' Yield, Market Value and Return for NYSE Common Stock](https://pdfs.semanticscholar.org/26ab/311756099c8f8c4e528083c9b90ff154f98e.pdf), Sanjoy Basu, Journal of Financial Economics, 1982
- [Bridging the divide in financial market forecasting: machine learners vs. financial economists](http://www.sciencedirect.com/science/article/pii/S0957417416302585), Expert Systems with Applications, 2016 
- [Financial Time Series Forecasting with Deep Learning : A Systematic Literature Review: 2005-2019](http://arxiv.org/abs/1911.13288), arXiv:1911.13288 [cs, q-fin, stat], 2019 
- [Empirical Asset Pricing via Machine Learning](https://doi.org/10.1093/rfs/hhaa009), The Review of Financial Studies, 2020 
- [The Characteristics that Provide Independent Information about Average U.S. Monthly Stock Returns](http://academic.oup.com/rfs/article/30/12/4389/3091648), The Review of Financial Studies, 2017 
- [Characteristics are covariances: A unified model of risk and return](http://www.sciencedirect.com/science/article/pii/S0304405X19301151), Journal of Financial Economics, 2019 
- [Estimation and Inference of Heterogeneous Treatment Effects using Random Forests](https://doi.org/10.1080/01621459.2017.1319839), Journal of the American Statistical Association, 2018 
- [An Empirical Study of Machine Learning Algorithms for Stock Daily Trading Strategy](https://www.hindawi.com/journals/mpe/2019/7816154/), Mathematical Problems in Engineering, 2019 
- [Predicting stock market index using fusion of machine learning techniques](http://www.sciencedirect.com/science/article/pii/S0957417414006551), Expert Systems with Applications, 2015 
- [Predicting stock and stock price index movement using Trend Deterministic Data Preparation and machine learning techniques](http://www.sciencedirect.com/science/article/pii/S0957417414004473), Expert Systems with Applications, 2015 
- [Deep Learning for Limit Order Books](http://arxiv.org/abs/1601.01987), arXiv:1601.01987 [q-fin], 2016 
- [Trading via Image Classification](http://arxiv.org/abs/1907.10046), arXiv:1907.10046 [cs, q-fin], 2019 
- [Algorithmic trading review](http://doi.org/10.1145/2500117), Communications of the ACM, 2013 
- [Assessing the impact of algorithmic trading on markets: A simulation approach](https://www.econstor.eu/handle/10419/43250), , 2008 
- [The Efficient Market Hypothesis and Its Critics](http://www.aeaweb.org/articles?id=10.1257/089533003321164958), Journal of Economic Perspectives, 2003 
- [The Arbitrage Pricing Theory Approach to Strategic Portfolio Planning](https://doi.org/10.2469/faj.v40.n3.14), Financial Analysts Journal, 1984 

### Industry News

- [The Rise of the Artificially Intelligent Hedge Fund](https://www.wired.com/2016/01/the-rise-of-the-artificially-intelligent-hedge-fund/#comments), Wired, 25-01-2016
- [Crowd-Sourced Quant Network Allocates Most Ever to Single Algo](https://www.bloomberg.com/news/articles/2018-08-02/crowd-sourced-quant-network-allocates-most-ever-to-single-algo), Bloomberg, 08-02-2018
- [Goldman Sachs’ lessons from the ‘quant quake’](https://www.ft.com/content/fdfd5e78-0283-11e7-aa5b-6bb07f5c8e12), Financial Times, 03-08-2017
- [Lessons from the Quant Quake resonate a decade later](https://www.ft.com/content/a7a04d4c-83ed-11e7-94e2-c5b903247afd), Financial Times, 08-18-2017
- [Smart beta funds pass $1tn in assets](https://www.ft.com/content/bb0d1830-e56b-11e7-8b99-0191e45377ec), Financial Times, 12-27-2017
- [BlackRock bets on algorithms to beat the fund managers](https://www.ft.com/content/e689a67e-2911-11e8-b27e-cc62a39d57a0), Financial Times, 03-20-2018
- [Smart beta: what’s in a name?](https://www.ft.com/content/d1bdabaa-a9f0-11e7-ab66-21cc87a2edde), Financial Times, 11-27-2017
- [Computer-driven hedge funds join industry top performers](https://www.ft.com/content/9981c870-e79a-11e6-967b-c88452263daf), Financial Times, 02-01-2017
- [Quants Rule Alpha’s Hedge Fund 100 List](https://www.institutionalinvestor.com/article/b1505pmf2v2hg3/quants-rule-alphas-hedge-fund-100-list), Institutional Investor, 06-26-2017
- [The Quants Run Wall Street Now](https://www.wsj.com/articles/the-quants-run-wall-street-now-1495389108), Wall Street Journal, 05-21-2017
- ['We Don’t Hire MBAs': The New Hedge Fund Winners Will Crunch The Better Data Sets](https://www.cbinsights.com/research/algorithmic-hedge-fund-trading-winners/), cbinsights, 06-28-2018
- [Artificial Intelligence: Fusing Technology and Human Judgment?](https://blogs.cfainstitute.org/investor/2017/09/25/artificial-intelligence-fusing-technology-and-human-judgment/), CFA Institute, 09-25-2017
- [The Hot New Hedge Fund Flavor Is 'Quantamental'](https://www.bloomberg.com/news/articles/2017-08-25/the-hot-new-hedge-fund-flavor-is-quantamental-quicktake-q-a), Bloomberg, 08-25-2017
- [Robots Are Eating Money Managers’ Lunch](https://www.bloomberg.com/news/articles/2017-06-20/robots-are-eating-money-managers-lunch), Bloomberg, 06-20-2017
- [Rise of Robots: Inside the World's Fastest Growing Hedge Funds](https://www.bloomberg.com/news/articles/2017-06-20/rise-of-robots-inside-the-world-s-fastest-growing-hedge-funds), Bloomberg, 06-20-2017
- [When Silicon Valley came to Wall Street](https://www.ft.com/content/ba5dc7ca-b3ef-11e7-aa26-bb002965bce8), Financial Times, 10-28-2017
- [BlackRock bulks up research into artificial intelligence](https://www.ft.com/content/4f5720ce-1552-11e8-9376-4a6390addb44), Financial Times, 02-19-2018
- [AQR to explore use of ‘big data’ despite past doubts](https://www.ft.com/content/3a8f69f2-df34-11e7-a8a4-0a1e63a52f9c), Financial Times, 12-12-2017
- [Two Sigma rapidly rises to top of quant hedge fund world](https://www.ft.com/content/dcf8077c-b823-11e7-9bfb-4a9c83ffa852), Financial Times, 10-24-2017
- [When Silicon Valley came to Wall Street](https://www.ft.com/content/ba5dc7ca-b3ef-11e7-aa26-bb002965bce8), Financial Times, 10-28-2017
- [Artificial intelligence (AI) in finance - six warnings from a central banker](https://www.bundesbank.de/en/press/speeches/artificial-intelligence--ai--in-finance--six-warnings-from-a-central-banker-711602), Deutsche Bundesbank, 02-27-2018
- [Fintech: Search for a super-algo](https://www.ft.com/content/5eb91614-bee5-11e5-846f-79b0e3d20eaf), Financial Times, 01-20-2016
- [Barron’s Top 100 Hedge Funds](https://www.barrons.com/articles/top-100-hedge-funds-1524873705)
- [How high-frequency trading hit a speed bump](https://www.ft.com/content/d81f96ea-d43c-11e7-a303-9060cb1e5f44), FT, 01-01-2018

### Books

- [Advances in Financial Machine Learning](https://www.wiley.com/en-us/Advances+in+Financial+Machine+Learning-p-9781119482086), Marcos Lopez de Prado, 2018
- [Quantresearch](http://www.quantresearch.info/index.html) by Marcos López de Prado
- [Quantitative Trading](http://epchan.blogspot.com/), Ernest Chan
- [Machine Learning in Finance](https://www.springer.com/gp/book/9783030410674), Dixon, Matthew F., Halperin, Igor, Bilokon, Paul, Springer, 2020

#### Machine Learning

- [Machine Learning](http://www.cs.cmu.edu/~tom/mlbook.html), Tom Mitchell, McGraw Hill, 1997
- [An Introduction to Statistical Learning](http://www-bcf.usc.edu/~gareth/ISL/), Gareth James et al.
    - Excellent reference for essential machine learning concepts, available free online
- [Bayesian Reasoning and Machine Learning](http://web4.cs.ucl.ac.uk/staff/D.Barber/textbook/091117.pdf), Barber, D., Cambridge University Press, 2012 (updated version available on author's website)

### Courses

- [Algorithmic Trading](http://personal.stevens.edu/~syang14/fe670.htm), Prof. Steve Yang, Stevens Institute of Technology
- [Machine Learning](https://www.coursera.org/learn/machine-learning), Andrew Ng, Coursera
- [Deep Learning Specialization](http://deeplearning.ai/), Andrew Ng
    - Andrew Ng’s introductory deep learning course
- Machine Learning for Trading Specialization, [Coursera](https://www.coursera.org/specializations/machine-learning-trading)
- Machine Learning for Trading, Georgia Tech CS 7646, [Udacity](https://www.udacity.com/course/machine-learning-for-trading--ud501
- Introduction to Machine Learning for Trading, [Quantinsti](https://quantra.quantinsti.com/course/introduction-to-machine-learning-for-trading)

### ML Competitions & Trading

- [IEEE Investment Ranking Challenge](https://www.crowdai.org/challenges/ieee-investment-ranking-challenge)
    - [Investment Ranking Challenge : Identifying the best performing stocks based on their semi-annual returns](https://arxiv.org/pdf/1906.08636.pdf)
- [Two Sigma Financial Modeling Challenge](https://www.kaggle.com/c/two-sigma-financial-modeling)
- [Two Sigma: Using News to Predict Stock Movements](https://www.kaggle.com/c/two-sigma-financial-news)
- [The Winton Stock Market Challenge](https://www.kaggle.com/c/the-winton-stock-market-challenge)
- [Algorithmic Trading Challenge](https://www.kaggle.com/c/AlgorithmicTradingChallenge)
   
### Python Libraries

- matplotlib [docs](https://github.com/matplotlib/matplotlib)
- numpy [docs](https://github.com/numpy/numpy)
- pandas [docs](https://github.com/pydata/pandas)
- scipy [docs](https://github.com/scipy/scipy)
- scikit-learn [docs](https://scikit-learn.org/stable/user_guide.html)
- LightGBM [docs](https://lightgbm.readthedocs.io/en/latest/)
- CatBoost [docs](https://catboost.ai/docs/concepts/about.html)
- TensorFlow [docs](https://www.tensorflow.org/guide)
- PyTorch [docs](https://pytorch.org/docs/stable/index.html)
- Machine Learning Financial Laboratory (mlfinlab) [docs](https://mlfinlab.readthedocs.io/en/latest/)
- seaborn [docs](https://github.com/mwaskom/seaborn)
- statsmodels [docs](https://github.com/statsmodels/statsmodels)
- [Boosting numpy: Why BLAS Matters](http://markus-beuckelmann.de/blog/boosting-numpy-blas.html)



















































